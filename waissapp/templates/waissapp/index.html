<!DOCTYPE html> 
{% load static %}
{% load crispy_forms_tags %}

<html>

<head>
    {% block meta_block %}
    {% endblock %}
    <meta charset=”utf-8”> 
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    

    <link rel="icon" type="image/png" href={% static "theme/waiss_logo.png" %}/>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <link href='https://fonts.googleapis.com/css?family=Josefin Sans' rel='stylesheet'>
  
    <!-- Custom fonts for this template-->
    <link href={% static "vendor/fontawesome-free/css/all.min.css" %} rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href={% static "css/sb-admin-2.min.css" %} rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href={% static "vendor/datatables/dataTables.bootstrap4.min.css" %} rel="stylesheet">

    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>

    <script>
      //Update clock
      function startTime() {
        var today = new Date();
        var h = today.getHours();
        var m = today.getMinutes();
        var s = today.getSeconds();
        var ampm = h >= 12 ? 'PM' : 'AM';
        m = checkTime(m);
        s = checkTime(s);
        h = h % 12;
        h = h ? h : 12; // the hour '0' should be '12'

        document.getElementById('time').innerHTML = h + ":" + m + ":" + s + ' ' + ampm;

        var month = today.getMonth() + 1;
        var day = today.getDate();
        var year = today.getFullYear();

        document.getElementById('date').innerHTML = month + '/' + day + '/' + year;

        var t = setTimeout(startTime, 500);
        }
        console.log(startTime(new Date));
        function checkTime(i) {
          if (i < 10) { i = "0" + i };  // add zero in front of numbers < 10
          return i;
        }
    </script>
    <script>
      //Data Table
      $(document).ready( function () {
        $('#dataTable').DataTable();
      } );
    </script>
    
    <title>
        {% block title_block %}
        WAISS
        {% endblock %}
    </title>
</head>

<body id="page-top" onload="startTime()">

  {% block style_block%}
  <style>
  .topbar {
    height: 50px;
  }
  .progress_bar .pro-bar {
      background: hsl(0, 0%, 97%);
      box-shadow: 0 1px 2px hsla(0, 0%, 0%, 0.1) inset;
      height:4px;
      margin-bottom: 12px;
      margin-top: 50px;
      position: relative;
    }
    .progress_bar .progress_bar_title{
    color: hsl(218, 4%, 50%);
    font-size: 15px;
    font-weight: 300;
    position: relative;
    top: -28px;
    z-index: 1;
}
.progress_bar .progress_number{
    float: right;
    margin-top: -24px;
}
.progress_bar .progress-bar-inner {
    background-color: hsl(0, 0%, 88%);
    display: block;
    width: 0;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    transition: width 1s linear 0s;
}
.progress_bar .progress-bar-inner:before {
    content: "";
    background-color: hsl(0, 0%, 100%);
    border-radius: 50%;
    width: 4px;
    height: 4px;
    position: absolute;
    right: 1px;
    top: 0;
    z-index: 1;
}
.progress_bar .progress-bar-inner:after {
    content: "";
    width: 14px;
    height: 14px;
    background-color: inherit;
    border-radius: 50%;
    position: absolute;
    right: -4px;
    top: -5px;
}
td {
    width: auto;
}

td.min {
    width: 1%;
    white-space: nowrap;
}

.highcharts-figure, .highcharts-data-table table {
    min-width: 310px; 
    max-width: 800px;
    margin: 0;
}

.highcharts-data-table table {
  font-family: Verdana, sans-serif;
  border-collapse: collapse;
  border: 1px solid #EBEBEB;
  margin: 10px auto;
  text-align: center;
  width: 100%;
  max-width: 500px;
}
.highcharts-data-table caption {
  padding: 1em 0;
  font-size: 1.2em;
  color: #555;
}
.highcharts-data-table th {
	font-weight: 600;
  padding: 0.5em;
}
.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
  padding: 0.5em;
}
.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}
.highcharts-data-table tr:hover {
    background: #f1f7ff;
}
.label-container{
	position:fixed;
	bottom:48px;
	right:105px;
	display:table;
	visibility: hidden;
}

.label-text{
	color:#FFF;
	background:rgba(51,51,51,0.5);
	display:table-cell;
	vertical-align:middle;
	padding:10px;
	border-radius:3px;
}

.label-arrow{
	display:table-cell;
	vertical-align:middle;
	color: white;
	opacity:0.5;
}

.float{
	position:fixed;
	width:60px;
	height:60px;
	bottom:40px;
	right:40px;
	color:#FFF;
	border-radius:50px;
	text-align:center;
	box-shadow: 2px 2px 3px #999;
	z-index:1000;
	animation: bot-to-top 2s ease-out;
}

.icon-ul{
	position:fixed;
	right:40px;
	padding-bottom:20px;
	bottom:50px;
	z-index:100;
}

.icon-li{
	list-style:none;
	margin-bottom:10px;
}

.icon-a{
	background-color:#5bc0de;
	color:#FFF;
	border-radius:50px;
	text-align:center;
	box-shadow: 2px 2px 3px #999;
	width:40px;
	height:40px;
	display:block;
}

.icon-ul:hover{
	visibility:visible!important;
	opacity:1!important;
}

.my-float{
	font-size:20px;
	margin-top:10px;
}

.icon-a#menu-share + .icon-ul{
  visibility: hidden;
}

.icon-a#menu-share:hover + .icon-ul{
  visibility: visible;
  animation: scale-in 0.5s;
}

.icon-a#menu-share .icon-i{
	animation: rotate-in 0.5s;
}

.icon-a#menu-share:hover > .icon-i{
	animation: rotate-out 0.5s;
}

@keyframes bot-to-top {
    0%   {bottom:-40px}
    50%  {bottom:40px}
}

@keyframes scale-in {
    from {transform: scale(0);opacity: 0;}
    to {transform: scale(1);opacity: 1;}
}

@keyframes rotate-in {
    from {transform: rotate(0deg);}
    to {transform: rotate(90deg);}
}

@keyframes rotate-out {
    from {transform: rotate(90deg);}
    to {transform: rotate(0deg);}
}
</style>
  {% endblock %}

  {% block dashboard_block %}
    <!-- Page Wrapper -->
    <div id="wrapper">
  
      <!-- Sidebar -->
      <ul class="navbar-nav bg-gradient-info sidebar sidebar-dark accordion" id="accordionSidebar">
  
        <!-- Sidebar - Brand -->
        <div class="sidebar-brand d-flex align-items-center justify-content-left" href="index.html">
          <div class="sidebar-brand-icon">
            <a href="{% url 'waiss:index' %}"><img src={% static "theme/waiss_logo.png" %} width=50px height=50px></a>
          </div>
          <div class="sidebar-brand-text mx-3">WAISS</div>
        </div>
  
        <!-- Nav Item - Dashboard -->
        <li class="nav-item active">
          <a class="nav-link" href="{% url 'waiss:index' %}">
            <i class="fas fa-fw fa-tachometer-alt"></i>
            <span>Dashboard</span></a>
        </li>
  
        <!-- Divider -->
        <hr class="sidebar-divider">
  
        <!-- Heading -->
        <div class="sidebar-heading">
          Input
        </div>

        <!-- Nav Item - Utilities Collapse Menu -->
        <li class="nav-item">
          <a class="nav-link " href="{% url 'waiss:add_system' %}">
            <i class="fas fa-clipboard-list"></i>
            <span class="text-gray-100">Create System</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseParam" aria-expanded="true" aria-controls="collapseParam">
            <i class="fas fa-plus-square"></i>
            <span class="text-gray-100">Parameters</span>
          </a>
          <div id="collapseParam" class="collapse" aria-labelledby="headingParam" data-parent="#accordionSidebar">
            <div class="bg-white py-2 collapse-inner rounded">
                <a class="collapse-item" href={% url 'waiss:add_farm' %}>Farm</a>
                <a class="collapse-item" href={% url 'waiss:add_personnel' %}>Farm Manager</a>
                <a class="collapse-item" href={% url 'waiss:add_crop' %}>Crop</a>
                <a class="collapse-item" href={% url 'waiss:add_soil' %}>Soil</a>
                <div class="collapse-item" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="true" aria-controls="collapseExample">
                  Irrigation
                  <div class="collapse bg-white collapse-inner rounded" id="collapseExample">
                    <a class="collapse-item" href={% url 'waiss:add_basin' %}>Basin</a>
                    <a class="collapse-item" href={% url 'waiss:add_border' %}>Border</a>
                    <a class="collapse-item" href={% url 'waiss:add_furrow' %}>Furrow</a>
                    <a class="collapse-item" href={% url 'waiss:add_sprinkler' %}>Sprinkler</a>
                    <a class="collapse-item" href={% url 'waiss:add_drip' %}>Drip</a>
                  </div>
                </div>
                <a class="collapse-item" href={% url 'waiss:add_fieldunit' %}>Field Unit</a>
                <a class="collapse-item" href={% url 'waiss:add_calib' %}>Calibration</a>
                <a class="collapse-item" href={% url 'waiss:add_sensor' %}>Sensors</a>
                <a class="collapse-item" href={% url 'waiss:add_mc' %}>MCv Readings</a>
            </div>
          </div>
        </li>
  
        <!-- Divider -->
        <hr class="sidebar-divider">
  
        <!-- Heading -->
        <div class="sidebar-heading">
          Database
        </div>
  
        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item">
          <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseDatabase" aria-expanded="true" aria-controls="collapseDatabase">
            <i class="fas fa-fw fa-database"></i>
            <span class="text-gray-100">Database</span>
          </a>
          <div id="collapseDatabase" class="collapse" aria-labelledby="headingDatabase" data-parent="#accordionSidebar">
            <div class="bg-white py-2 collapse-inner rounded">
                <a class="collapse-item" href={% url 'waiss:list_system' %}>Systems</a>
                <hr>
                <a class="collapse-item" href={% url 'waiss:list_farm' %}>Farms</a>
                <a class="collapse-item" href={% url 'waiss:list_personnel' %}>Farm Manager</a>
                <a class="collapse-item" href={% url 'waiss:list_crop' %}>Crops</a>
                <a class="collapse-item" href={% url 'waiss:list_soil' %}>Soil</a>
                <div class="collapse-item" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="true" aria-controls="collapseExample">
                  Irrigation
                  <div class="collapse bg-white collapse-inner rounded" id="collapseExample">
                    <a class="collapse-item" href={% url 'waiss:list_basin' %}>Basin</a>
                    <a class="collapse-item" href={% url 'waiss:list_border' %}>Border</a>
                    <a class="collapse-item" href={% url 'waiss:list_furrow' %}>Furrow</a>
                    <a class="collapse-item" href={% url 'waiss:list_sprinkler' %}>Sprinkler</a>
                    <a class="collapse-item" href={% url 'waiss:list_drip' %}>Drip</a>
                  </div>
                </div>
                <a class="collapse-item" href={% url 'waiss:list_fieldunit' %}>Field Units</a>
                <a class="collapse-item" href={% url 'waiss:list_calib' %}>Calibration Constants</a>
                <a class="collapse-item" href={% url 'waiss:list_sensor' %}>Sensors & MCv Readings</a>
            </div>
          </div>
        </li>
        <!-- Divider -->
        <hr class="sidebar-divider">
  
        <!-- Heading -->
        <div class="sidebar-heading">
          About
        </div>

        <li class="nav-item">
          <a class="nav-link" href={% url 'waiss:about' %}><i class="fas fa-address-card"></i>
            <span class="text-gray-100">About Us</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href={% url 'waiss:about_calc' %}><i class="fas fa-square-root-alt"></i>
          <span class="text-gray-100">About the Calculations</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block">
  
        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline">
          <button class="rounded-circle border-0" id="sidebarToggle"></button>
        </div>
  
      </ul>
      <!-- End of Sidebar -->
  
      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">
  
        <!-- Main Content -->
        <div id="content">
  
          <!-- Topbar -->
          <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
  
            <!-- Sidebar Toggle (Topbar) -->
            <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
              <i class="fa fa-bars"></i>
            </button>
            <!-- Topbar Navbar -->
            <ul class="navbar-nav ml-auto">
              {% if user.is_authenticated %}
              <!-- Nav Item - Search Dropdown (Visible Only XS) -->
              <li class="nav-item dropdown no-arrow d-sm-none">
                <a class="nav-link dropdown-toggle" href="" id="searchDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="fas fa-search fa-fw"></i>
                </a>
                <!-- Dropdown - Messages -->
                <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in" aria-labelledby="searchDropdown">
                  <form class="form-inline mr-auto w-100 navbar-search">
                    <div class="input-group">
                      <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..." aria-label="Search" aria-describedby="basic-addon2">
                      <div class="input-group-append">
                        <button class="btn btn-primary" type="button">
                          <i class="fas fa-search fa-sm"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </li>
              <li class="nav-item">
                  <div class="nav-link"><small><span id="date"></span>&nbsp;&nbsp;<span id="time"></span></small></div>
              </li>
            <!-- Nav Item - Messages -->
            <li class="nav-item">
              <a class="nav-link" href="#" id="messagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-envelope fa-fw"></i>
              </a>
              <!-- Dropdown - Messages -->
              <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="messagesDropdown">
                <h6 class="dropdown-header">
                  Message Center
                </h6>
                {% for msgs in final_list %}
                <a class="dropdown-item d-flex align-items-center" href={% url 'waiss:view-conversation' msgs.number %}>
                  <div class="mr-3">
                    <div class="icon-circle bg-primary">
                      <i class="fas fa-file-alt text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">{{msgs.timestamp}}</div>
                    <span class="small font-weight-bold">{{msgs.number}}: {{msgs.msg}}</span>
                  </div>
                </a>
                {% endfor %}
                <a class="dropdown-item text-center small text-gray-500" href="{% url 'waiss:messages' %}">Show All Alerts</a>
              </div>
            </li>
  
              <div class="topbar-divider d-none d-sm-block"></div>
  
              <!-- Nav Item - User Information -->
              <li class="nav-item dropdown no-arrow">
                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <span class="mr-2 d-none d-lg-inline text-gray-600 small">{{ user.get_username }}</span>
                  <img class="img-profile rounded-circle" src="https://source.unsplash.com/QAB-WJcbgJk/60x60">
                </a>
                <!-- Dropdown - User Information -->
                <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown">
                  <a class="dropdown-item" href="{% url 'waiss:profile' %}">
                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                    Profile
                  </a>
                  <a class="dropdown-item" href="#">
                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                    Settings
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="{% url 'logout'%}?next={{request.path}}">
                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                    Logout
                  </a>
                </div>
              </li>
              {% else %}
              <li><a href="{% url 'login'%}?next={{request.path}}">Login</a></li>
              {% endif %}
            </ul>
          </nav>
          <!-- End of Topbar -->
  
          <!-- Begin Page Content -->
          <div class="container-fluid">
          {% endblock %}

          {% block main_block %}
          
          <div class="row">
            <div class="col text-gray-800">
              <form method="post">
                {% csrf_token %}
                <label class="mb-0 font-weight-bold text-gray-800">System: </label>
                    <select name="selected_system" id="selected_system" class="btn btn-secondary btn-sm">
                      <option>{{selected_system}}</option>
                      {% for system in form %}
                      <option value="{{system.name}}">{{system}}</option>
                      {% endfor %}
                    </select>
                    <input class="btn btn-info btn-sm" type="submit" value="Generate Irrigation Advisory">
                    <a class="btn btn-info btn-sm" type="button" href="{% url 'waiss:list_system' %}">Modify System</a>
              </form>
            </div>
          </div>
          <hr>
          <div class="row">
            <!--Crop Card -->
            <div class="col-xl-3 col-md-6 mb-4">
              <div class="card border-left-primary shadow">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col">
                      <div class="mb-0 font-weight-bold text-gray-800">{{crop}}</div>
                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Crop</div>
                      <small>{{crop_dat}} / {{crop_growingperiod}} days<br> <!--crop_dat based on latest mc_reading-->
                        MAD: {{crop_mad}}%
                        {% if drip %}| Area Shaded: {{area_shaded}} %{% endif%}
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Soil Card -->
            <div class="col-xl-3 col-md-6 mb-4">
              <div class="card border-left-info shadow">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col">
                      <div class="mb-0 mr-3 font-weight-bold text-gray-800">{{soil}}</div>
                      <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Soil</div>
                      <small>
                        {% if basin %}
                          FC: {{soil_fc}}% &nbsp;PWP: {{soil_pwp}}% MCv<br>Intake Family: {{intake_family}}
                          {% elif border %}
                          FC: {{soil_fc}}% &nbsp;PWP: {{soil_pwp}}% MCv<br>Intake Family: {{intake_family}}
                          {% elif furrow %}
                          FC: {{soil_fc}}% &nbsp;PWP: {{soil_pwp}}% MCv<br>Intake Family: {{intake_family}}
                          {% elif sprinkler %}
                          FC: {{soil_fc}}% MCv<br>PWP: {{soil_pwp}}% MCv
                          {% elif drip %}
                          FC: {{soil_fc}}% MCv<br>PWP: {{soil_pwp}}% MCv
                        {% endif %}
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Irrigation Card -->
            <div class="col-xl-3 col-md-6 mb-4">
              <div class="card border-left-warning shadow">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col">
                      <div class="mb-0 font-weight-bold text-gray-800">
                        {% if basin %} {{basin}}
                          {% elif drip %} {{drip}}
                          {% elif border %} {{border}}
                          {% elif furrow %} {{furrow}}
                          {% elif sprinkler %} {{sprinkler}}
                        {% endif %}</div>
                      <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Irrigation System</div>
                        <small>type: 
                          {% if basin %} basin
                          {% elif drip %} drip
                          {% elif border %} border
                          {% elif furrow %} furrow
                          {% elif sprinkler %} sprinkler
                          {% endif %}
                          <br> unit discharge: 
                          {% if not drip %}
                          {{irrigation_q}} lps
                          {% else %}
                          {{irrigation_q}} l/day
                          {% endif %}
                        </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          <!-- Calibration Card-->
            <div class="col-xl-3 col-md-6 mb-4">
              <div class="card border-left-success shadow">
                <div class="card-body">
                  <div class="row no-gutters align-items-center">
                    <div class="col">
                      <div class="mb-0 mr-3 font-weight-bold text-gray-800">{{calib}}</div>
                      <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Calibration</div>
                      <small>{{calib_eqn}} <br>
                        {% if calib_eqn == "quadratic" %}{{calib_coeff_a}}x<sup>2</sup> + {{calib_coeff_b}}x + {{calib_coeff_c}}{% endif %}
                        {% if calib_eqn == "linear" %}{{calib_coeff_a}}x + {{calib_coeff_b}}{% endif %}
                        {% if calib_eqn == "exponential" %}{{calib_coeff_a}}xe<sup>{{calib_coeff_b}}</sup>{% endif %}
                        {% if calib_eqn == "logarithmic" %}{{calib_coeff_a}}ln(x) + {{calib_coeff_b}}{% endif %}
                        {% if calib_eqn == "symmetrical sigmoidal" %}{{calib_coeff_d}} + ({{calib_coeff_a}} - {{calib_coeff_d}})/(1 + (x/{{calib_coeff_c}})<sup>{{calib_coeff_b}}</sup>){% endif %}
                        {% if calib_eqn == "asymmetrical sigmoidal" %}{{calib_coeff_d}} + ({{calib_coeff_a}} - {{calib_coeff_d}})/((1 + (x/c{{calib_coeff_c}})<sup>{{calib_coeff_b}}</sup>))<sup>{{calib_coeff_m}}</sup>{% endif %}
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Content Row -->

          <div class="row">
            <!-- Irrigation Advisory -->
            <div class="col-3">
              <div class="card border-left-primary shadow mb-4">
                <div class="card-body">
                  <div class="text-center">
                    <img src={% static "theme/Advisory.png" %}>
                    <br><br>
                    <div class="mb-0 mr-3 font-weight-bold text-gray-800">{% if mc_ave < MC_TO_IRRIGATE %}IRRIGATE{% endif %}{% if not mc_ave < MC_TO_IRRIGATE %}IRRIGATION NOT NEEDED{% endif %}<hr style="margin-left:0 ; padding:0; line-height:1px;"></div>
                    <div><span class="small">Irrigation Period</span>: <b>{{irrigation_period}} mins</b></div>
                    <div><span class="small">Volume</span>: <b>{{total_volume}} m<sup>3</sup>{% if irrigation_type == "drip" %}/plant{% endif %}</b></div>
                    <div><span class="small">Net Application Depth</span>: {{net_application_depth}} mm</div><hr>
                    <div class="small">Latest MC<sub>v</sub>: {{mc_ave}} % </div> 
                    <div class="small">MC<sub>v</sub> to irrigate: {{MC_TO_IRRIGATE}} %</div>
                    <div class="small">Effective DRZ: {{drz}} mm</div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Line Chart -->
            <div class="col-9">
              <div class="card shadow mb-4">
                <!-- Card Body -->
                <div class="card-body">
                  <figure class="highcharts-figure">
                    <div id="container">
                    </div>
                  </figure>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- icons -->
        <a class="float icon-a fa-rotate-90" id="menu-share" style="display: inline-block;">
          <i class="fas fa-share fa-flip-horizontal my-float icon-i"></i>
        </a>
        <ul class="icon-ul">
          <li class="icon-li">
            <a href={% url 'waiss:add_gravimetric' %} class="icon-a"><img src={% static "theme/microwave-white-18dp.svg" %} class="my-float icon-i" title="add gravimetric soil moisture content"></a>
          </li>
          <li class="icon-li">
            <a href={% url 'waiss:add_shaded' %} class="icon-a"><i class="fa fa-sun my-float icon-i" title="add percent shaded area"></i></a>
          </li>
          <li class="icon-li">
            <a href={% url 'waiss:add_mc' %} class="icon-a"><i class="fas fa-tint my-float icon-i" title="add soil moisture reading"></i></a>
          </li>
          <li class="icon-li">
            <a href={% url 'waiss:add_rainfall' %} class="icon-a"><i class="fas fa-oil-can my-float icon-i" title="add rainfall/irrigation"></i></a>
          </li>
        </ul>
{% endblock %}
        </div>
        <!-- /.container-fluid -->

      </div>
      <!-- End of Main Content -->
{% block footer_block %}
      <!-- Footer -->
      <!-- End of Footer -->
{% endblock %}

    </div>
  <!-- End of Content Wrapper -->
  <!-- End of Page Wrapper -->
  
  
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
    
    $('.dropdown-toggle').dropdown()
    $('.collapse').collapse()
  </script>
  <!-- Bootstrap core JavaScript-->
  <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}"></script>
  <script src="{% static 'js/sb-admin-2.min.js' %}"></script>
  <!-- Page level plugins -->
  <script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
  <script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>
  <!-- Page level custom scripts -->
  <script src="{% static 'js/demo/datatables-demo.js' %}"></script>

{% block bottom_script_block %}
<script type="text/javascript">
  Highcharts.chart('container', {
  chart: {
      type: 'spline'
  },
  title: {
      text: '{{fieldunit.name}}'
  },
  subtitle: {
      text: 'Soil Moisture Content'
  },
  xAxis: {
      categories: [{% for t in mc_time_1 %}"{{t.timestamp|date:'m-d H:i'}}",{% endfor %}],
      tickmarkPlacement: 'on',
      title: {
          enabled: false
      }
  },
  yAxis: [{
    title: {
      text: 'Depth (mm)'
    },
    min: 0,
    opposite: true
  }, {
    title: {
      text: 'MCv (%)'
    },
    min: 0,
    opposite: false
  }],
  tooltip: {
      split: true,
      valueSuffix: ''
  },
  plotOptions: {
      area: {
          stacking: 'normal',
          lineColor: '#666666',
          lineWidth: 1,
          marker: {
              lineWidth: 1,
              lineColor: '#666666'
          }
      }
  },
  series: [{
    type: 'areaspline',
    name: 'FC',
    yAxis: 1,
    data:[{% for x in series_fc %}{{x}},{% endfor %}],
    checkbox: { checked: true },
    color: 'rgb(91, 192, 222)',
    fillOpacity : '0.1',
    dashStyle: 'dot',
    marker: {
      enabled: false,
      lineWidth: 1,}
  }, {
    type: 'areaspline',
    name: 'PWP',
    yAxis: 1,
    data: [{% for x in series_pwp %}{{x}},{% endfor %}],
    checkbox: { checked: true },
    color: 'rgb(217, 83, 79)',
    fillOpacity : '0.1',
    dashStyle: 'dot',
    marker: {
      enabled: false,
      lineWidth: 1}
  }, {
    type: 'column',
    name: 'Net Application Depth (mm)',
    yAxis: 0,
    data:[{% for x in Fn_collection %}{{x}},{% endfor %}],
    checkbox: { checked: true },
    dashStyle: 'dot',
    marker: {
      enabled: false,
      lineWidth: 1}
  }, {
    type: 'column',
    name: 'Rainfall/Irrigation (mm)',
    yAxis: 0,
    data:[{% for x in rainfall %}{{x}},{% endfor %}],
    checkbox: { checked: true },
    dashStyle: 'dot',
    marker: {
      enabled: false,
      lineWidth: 1}

  }, {
    type: 'scatter',
    name: 'Gravimetric MCv (%)',
    yAxis: 1,
    data: [{% for x in gravimetric_collection %}{{x}},{% endfor %}],
    checkbox: { checked: true },
    marker: {
      enabled: true}
  }, {
    name: '{% for s in s1 %}{{s.name}} ({{s.depth}} m){% endfor %}',
    checkbox: { checked: true },
    yAxis: 1,
    data: [{% for m in mc_1 %}{{m}},{% endfor %}],
    marker: {
      enabled: false,
      lineWidth: 1}
  }, {
    name: '{% for s in s2 %}{{s.name}} ({{s.depth}} m){% endfor %}',
    checkbox: { checked: true },
    yAxis: 1,
    data: [{% for m in mc_2 %}{{m}},{% endfor %}],
    marker: {
      enabled: false,
      lineWidth: 1}
  }, {
    name: '{% for s in s3 %}{{s.name}} ({{s.depth}} m){% endfor %}',
    checkbox: { checked: true },
    yAxis: 1,
    data: [{% for m in mc_3 %}{{m}},{% endfor %}],
    marker: {
      enabled: false,
      lineWidth: 1}
  }, {
    type: 'spline',
    name: 'Weighted MCv',
    yAxis: 1,
    data:[{% for m in mc_ave_collection %}{{m}},{% endfor %}],
    checkbox: { checked: true },
    dashStyle: 'dash',
    marker: {
      enabled: true,
      lineWidth: 1}
  }],
});
</script>
{% endblock %}
    
</body>
</html>